<?php


class ColorSet {
	public $shade_count;
	public $hue_count;
	public $colors;

	public function __construct ($shade_count = 7, $hue_count = 13) {
		$this->shade_count = $shade_count;
		$this->hue_count = $hue_count;
	}
	
	private function generateAllHues () {
		return array (
			array (0.5,0.5,0.5),
			array (  1,  0,  0),
			array (  1,0.5,  0),
			array (  1,  1,  0),
			array (0.5,  1,  0),
			array (  0,  1,  0),
			array (  0,  1,0.5),
			array (  0,  1,  1),
			array (  0,0.5,  1),
			array (  0,  0,  1),
			array (0.5,  0,  1),
			array (  1,  0,  1),
			array (  1,  0,0.5),
		);
	}
	
	private function generateHues ($hue_count = null) {
		if (!isset($hue_count)) $hue_count = $this->hue_count;
		$all = $this->generateAllHues();
		if ($hue_count < count($all)) {
			$hues = array();
			$keep = (int)($hue_count / 4);
			for ($i=0; $i<count($all);$i++) {
				if ($i%4 <= $keep) $hues[] = $all[$i];
			}
			$hues = array_splice($hues, 0, $hue_count);
			return $hues;
		} else return $all;
	}
	
	
	public function generateSet ($shade_count = null, $hue_count = null) {
		if (!isset($shade_count)) $shade_count = $this->shade_count;
		$hues = $this->generateHues($hue_count);
		$colors = array ();
		$darks = ceil($shade_count/2);
		$lights = floor($shade_count/2);
		
		for ($g=0; $g < $darks; $g++) {
			$colors[$g] = array();
			$shade = (int)(255*($g+1)/$darks);
			if ($shade > 255) $shade = 255;
			for ($h=0; $h < count($hues); $h++) {
				$colors[$g][$h] = '';
				for ($i=0; $i<count($hues[$h]); $i++) {
					$clr = dechex($hues[$h][$i]*$shade);
					if (strlen($clr)<2) $clr = '0'.$clr;
					$colors[$g][$h] .= $clr;
				}
			}
		}
		
		for ($g=0; $g < $lights; $g++) {
			$colors[$g+$darks] = array();
			$add = ($g+1)/($lights+1);
			
			for ($h=0; $h < count($hues); $h++) {
				$colors[$g+$darks][$h] = '';
				for ($i=0; $i<count($hues[$h]); $i++) {
					$clr = $hues[$h][$i]*255;
					$clr = $clr + (255-$clr)*$add;
					if ($clr > 255) $clr = 255;
					$clr = dechex($clr);
					if (strlen($clr)<2) $clr = '0'.$clr;
					$colors[$g+$darks][$h] .= $clr;
				}
			}
		}		
		return $colors;
	}

	public function generateChart ($shade_count = null, $hue_count = null) {
		$set = $this->generateSet($shade_count, $hue_count);
		$content = '<div class="colorChart"><ul class="colorChart-shades">';
		foreach ($set as $shade) {
			$content .= '<li><ul class="colorChart-hues">';
			foreach ($shade as $hue) {
				$content .= '<li><div style="background: #'.$hue.';"></div></li>';
			}
			$content .= '</ul></li>';
		}
		$content .= '</ul></div>';
		return $content;
	}
}



